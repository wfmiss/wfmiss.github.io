<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>输入输出系统接口芯片 | wfmiss Notes</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="我们在黑暗中并肩前行，走在各自的朝圣路上!">
    <meta name="keywords" content="wfmiss,eric">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.6c3cad56.css" as="style"><link rel="preload" href="/assets/js/app.f3f1a81b.js" as="script"><link rel="preload" href="/assets/js/2.b7d28b34.js" as="script"><link rel="preload" href="/assets/js/12.c81a73a2.js" as="script"><link rel="prefetch" href="/assets/js/10.3dcb08b2.js"><link rel="prefetch" href="/assets/js/11.0a18f7bd.js"><link rel="prefetch" href="/assets/js/13.c98c26c1.js"><link rel="prefetch" href="/assets/js/14.36d42ece.js"><link rel="prefetch" href="/assets/js/15.bda77217.js"><link rel="prefetch" href="/assets/js/16.80047c9b.js"><link rel="prefetch" href="/assets/js/17.548d378f.js"><link rel="prefetch" href="/assets/js/18.86a99a23.js"><link rel="prefetch" href="/assets/js/19.f47c7d29.js"><link rel="prefetch" href="/assets/js/20.7e536bfb.js"><link rel="prefetch" href="/assets/js/21.6dac4a9e.js"><link rel="prefetch" href="/assets/js/22.c40c5423.js"><link rel="prefetch" href="/assets/js/23.e52bc27f.js"><link rel="prefetch" href="/assets/js/24.bfa36715.js"><link rel="prefetch" href="/assets/js/25.195a37e7.js"><link rel="prefetch" href="/assets/js/26.2e9f5321.js"><link rel="prefetch" href="/assets/js/27.6e80d82e.js"><link rel="prefetch" href="/assets/js/28.2cd04043.js"><link rel="prefetch" href="/assets/js/29.47a1754b.js"><link rel="prefetch" href="/assets/js/3.c5f9f392.js"><link rel="prefetch" href="/assets/js/30.7d2dd507.js"><link rel="prefetch" href="/assets/js/31.d395de78.js"><link rel="prefetch" href="/assets/js/32.99af69ad.js"><link rel="prefetch" href="/assets/js/33.1e427cb5.js"><link rel="prefetch" href="/assets/js/34.f9dd6bb5.js"><link rel="prefetch" href="/assets/js/35.d7896692.js"><link rel="prefetch" href="/assets/js/4.f06af0e8.js"><link rel="prefetch" href="/assets/js/5.76fab509.js"><link rel="prefetch" href="/assets/js/6.e8823ccd.js"><link rel="prefetch" href="/assets/js/7.64b43ff1.js"><link rel="prefetch" href="/assets/js/8.a6738900.js"><link rel="prefetch" href="/assets/js/9.4baf5fe4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6c3cad56.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">wfmiss Notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记" class="dropdown-title"><!----> <span class="title" style="display:;">笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/0/" class="nav-link">考试报名流程</a></li><li class="dropdown-item"><!----> <a href="/c/" class="nav-link">C语言</a></li><li class="dropdown-item"><!----> <a href="/smc/0/" class="nav-link">SMC</a></li><li class="dropdown-item"><!----> <a href="/vue/note0/" class="nav-link">Vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="练习题" class="dropdown-title"><!----> <span class="title" style="display:;">练习题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/c1/1/" class="nav-link">C语言</a></li><li class="dropdown-item"><!----> <a href="/c1/" class="nav-link router-link-active">SMC&amp;P</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/wfmiss/notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记" class="dropdown-title"><!----> <span class="title" style="display:;">笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/0/" class="nav-link">考试报名流程</a></li><li class="dropdown-item"><!----> <a href="/c/" class="nav-link">C语言</a></li><li class="dropdown-item"><!----> <a href="/smc/0/" class="nav-link">SMC</a></li><li class="dropdown-item"><!----> <a href="/vue/note0/" class="nav-link">Vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="练习题" class="dropdown-title"><!----> <span class="title" style="display:;">练习题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/c1/1/" class="nav-link">C语言</a></li><li class="dropdown-item"><!----> <a href="/c1/" class="nav-link router-link-active">SMC&amp;P</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/wfmiss/notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/c1/1/" class="sidebar-link">C语言编程题</a></li><li><a href="/c1/2/" class="sidebar-link">微机原理简答题</a></li><li><a href="/c1/3/" class="sidebar-link">微机原理填空题</a></li><li><a href="/c1/4/" class="sidebar-link">微机原理指令集</a></li><li><a href="/c1/5/" aria-current="page" class="active sidebar-link">输入输出系统接口芯片</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/c1/5/#输入输出-i-o-接口概念" class="sidebar-link">输入输出（I/O）接口概念</a></li><li class="sidebar-sub-header"><a href="/c1/5/#数据传送方式" class="sidebar-link">数据传送方式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/c1/5/#一、无条件传送方式-同步" class="sidebar-link">一、无条件传送方式（同步）</a></li><li class="sidebar-sub-header"><a href="/c1/5/#二、查询传送方式-异步" class="sidebar-link">二、查询传送方式（异步）</a></li><li class="sidebar-sub-header"><a href="/c1/5/#三、中断传送方式-int-21h" class="sidebar-link">三、中断传送方式：int 21h</a></li><li class="sidebar-sub-header"><a href="/c1/5/#四、dma传送方式" class="sidebar-link">四、DMA传送方式</a></li></ul></li><li class="sidebar-sub-header"><a href="/c1/5/#并行通信" class="sidebar-link">并行通信</a></li><li class="sidebar-sub-header"><a href="/c1/5/#一、8255a的内部结构和引脚" class="sidebar-link">一、8255A的内部结构和引脚：</a></li><li class="sidebar-sub-header"><a href="/c1/5/#二、8255a的工作方式" class="sidebar-link">二、8255A的工作方式</a></li><li class="sidebar-sub-header"><a href="/c1/5/#三、8255a的编程" class="sidebar-link">三、8255A的编程</a></li><li class="sidebar-sub-header"><a href="/c1/5/#一、概念" class="sidebar-link">一、概念</a></li><li class="sidebar-sub-header"><a href="/c1/5/#二、通用异步接收发送器uart-8251、8250" class="sidebar-link">二、通用异步接收发送器UART（8251、8250）</a></li><li class="sidebar-sub-header"><a href="/c1/5/#一、中断控制器8259a" class="sidebar-link">一、中断控制器8259A</a></li><li class="sidebar-sub-header"><a href="/c1/5/#二、8259a的中断过程" class="sidebar-link">二、8259A的中断过程</a></li><li class="sidebar-sub-header"><a href="/c1/5/#三、8259a的工作方式" class="sidebar-link">三、8259A的工作方式</a></li><li class="sidebar-sub-header"><a href="/c1/5/#四、8259a的编程" class="sidebar-link">四、8259A的编程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/c1/5/#初始化编程" class="sidebar-link">初始化编程</a></li></ul></li><li class="sidebar-sub-header"><a href="/c1/5/#一、定时-计数器原理" class="sidebar-link">一、定时/计数器原理</a></li><li class="sidebar-sub-header"><a href="/c1/5/#二、8253的内部结构和引脚" class="sidebar-link">二、8253的内部结构和引脚</a></li><li class="sidebar-sub-header"><a href="/c1/5/#三、8253的工作方式" class="sidebar-link">三、8253的工作方式</a></li><li class="sidebar-sub-header"><a href="/c1/5/#四、8253的编程" class="sidebar-link">四、8253的编程</a></li><li class="sidebar-sub-header"><a href="/c1/5/#一、8237-dma概述" class="sidebar-link">一、8237 DMA概述</a></li><li class="sidebar-sub-header"><a href="/c1/5/#二、8237-dma数据传送的工作过程" class="sidebar-link">二、8237 DMA数据传送的工作过程</a></li><li class="sidebar-sub-header"><a href="/c1/5/#三、dma控制器8237a" class="sidebar-link">三、DMA控制器8237A</a></li></ul></li><li><a href="/c1/6/" class="sidebar-link">微机原理简答题</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-0c557b5e><div class="articleInfo" data-v-0c557b5e><ul class="breadcrumbs" data-v-0c557b5e><li data-v-0c557b5e><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-0c557b5e></a></li> <li data-v-0c557b5e><a href="/c1/#练习题" data-v-0c557b5e>练习题</a></li></ul> <div class="info" data-v-0c557b5e><div title="作者" class="author iconfont icon-touxiang" data-v-0c557b5e><a href="https://wfmiss.cn" target="_blank" title="作者" class="beLink" data-v-0c557b5e>eric</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-0c557b5e><a href="javascript:;" data-v-0c557b5e>2022-04-11</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">输入输出系统接口芯片<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="输入输出系统接口芯片"><a href="#输入输出系统接口芯片" class="header-anchor">#</a> 输入输出系统接口芯片</h1> <h2 id="输入输出-i-o-接口概念"><a href="#输入输出-i-o-接口概念" class="header-anchor">#</a> 输入输出（I/O）接口概念</h2> <p>一、I/O接口概念</p> <p>1、为什么需要I/O接口（电路）？</p> <ul><li>微机的外部设别多种多样</li> <li>工作原理、信息格式、工作速度等方面差别很大</li> <li>外设不能与CPU直接向相连</li> <li>必须经过中间电路再与系统相连</li></ul> <p>2、什么是I/O接口电路？</p> <ul><li>I/O接口是位于系统与外设间、用来协助完成数据传送和控制任务的逻辑电路；</li> <li>可编程接口芯片、I/O总线槽的电路板（适配器）都是接口电路。</li></ul> <p>3、I/O接口的主要功能</p> <ul><li>速度匹配、数据缓冲；</li> <li>数据格式的转换；</li> <li>对I/O端口寻址、地址译码；</li> <li>CPU与外设信息联络；</li> <li>设置中断和DMA控制逻辑</li></ul> <p>4、端口（PORT）</p> <ul><li>泛指I/O地址，对应接口电路的寄存器；</li> <li>一个接口电路可以具有多个I/O端口（寄存器）</li> <li>数据端口、状态端口和控制端口：用于保存数据、状态信息</li></ul> <p>二、I/O接口的典型结构</p> <p>1、接口结构</p> <p>2、I/O接口组成</p> <p>接口由硬件和软件组成。</p> <p>接口软件有两类：</p> <ul><li>初始化程序段：
<ul><li>设备驱动程序、设定芯片工作方式等</li></ul></li> <li>数据交换程序段：
<ul><li>管理、控制、驱动外设，负责和系统间信息交换。</li></ul></li></ul> <p>三、I/O端口的编址</p> <p>两类编址</p> <ul><li>I/O端口单独编址（独立编址）：
<ul><li>I/O地址空间独立于存储地址空间，内存与I/O空间各自独立</li> <li>如：8086/8088</li></ul></li> <li>I/O端口与存储器统一编址：
<ul><li>他们共享一个地址空间，内存与I/O空间共用</li> <li>如：M6800</li></ul></li></ul> <p>独立编址：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>优点：
- I/O端口的地址空间独立
- 控制和地址译码电路简单
- 专门的I/O指令
缺点：
- I/O指令种类少
- 空间少
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>统一编址：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>优点：
- 不需要专门的I/O指令
- I/O数据存取灵活
缺点：
- I/O端口要占去部分存储器地址空间
- 程序不易阅读（不易分清访问存储器和访问外设）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>四、88/86的输入输出指令</p> <p>1、I/O端口地址</p> <ul><li>外设的端口（PORT），即I/O地址。</li> <li>88/86用于寻址外设端口的地址线为16条，</li> <li>端口最多为2的16次方=65536（64KB）个，</li> <li>端口号为：0000H-FFFFH</li></ul> <p>2、I/O端口寻址方式</p> <p>88/86的端口有64KB，不分段，两种寻址方式：</p> <ul><li>直接寻址：
<ul><li>只寻址00H-FFH前256个端口号</li> <li>指令中操作数直接使用端口号；</li></ul></li> <li>间接寻址：
<ul><li>可寻址全部64K个端口号：0000H-FFFFH</li> <li>DX寄存器的值存放端口号；</li> <li>0100H-FFFFH的端口只能采用间接寻址方式。</li></ul></li></ul> <p>3、输入指令</p> <p>将外设数据传送给CPU内的AL/AX：</p> <ul><li><code>IN AL,端口地址</code></li> <li><code>IN AL,DX/i8 ;字节输入</code></li> <li><code>IN AX,DX/i8 ;字输入</code></li></ul> <p>4、输出指令</p> <p>将CPU内的AL/AX数据传送给外设：</p> <ul><li><code>OUT 端口地址,AL/AX</code></li> <li><code>OUT DX/i8,AL ;字节输出</code></li> <li><code>OUT DX/i8,AX ;字输出</code></li></ul> <p>五、I/O地址的译码</p> <ul><li>门电路：接口电路只占少量I/O地址，可以利用线选法地址译码。</li> <li>译码器：选用2：4译码器或3：8译码器进行</li></ul> <p>1、逻辑门电路进行I/O地址译码</p> <h2 id="数据传送方式"><a href="#数据传送方式" class="header-anchor">#</a> 数据传送方式</h2> <ul><li>程序控制的数据传送：CPU执行程序中I/O指令完成传送，分为：无条件传送、查询传送、中断传送。</li> <li>直接存储器存取（DMA）：
<ul><li>硬件芯片8237；</li> <li>DMAC利用系统总线在外设和主存间传送。</li></ul></li> <li>I/O处理机实现数据传送：
<ul><li>协处理器8089：数据输入/出</li> <li>CPU委托专门的I/O处理机来完成数据传送。</li></ul></li></ul> <h3 id="一、无条件传送方式-同步"><a href="#一、无条件传送方式-同步" class="header-anchor">#</a> 一、无条件传送方式（同步）</h3> <p>1、原理：</p> <ul><li>CPU与慢速外设交换数据；</li> <li>外设处于“就绪”状态，随时可以进行数据传送，亦称同步传送；</li> <li>适用于简单设备，如：LED数码管，按键等；</li> <li>传送条件：外设必须随时就绪。</li></ul> <h3 id="二、查询传送方式-异步"><a href="#二、查询传送方式-异步" class="header-anchor">#</a> 二、查询传送方式（异步）</h3> <p>1、原理</p> <ul><li>CPU先查询外设的工作状态，</li> <li>在外设就绪时，实现数据输入或输出；</li> <li>查询传送的特点是：工作可靠，但传送效率低。</li></ul> <p>2、查询传送的两个环节</p> <ul><li>查询
<ul><li>寻址状态口</li> <li>读取状态端口的状态位；</li> <li>若无就绪就继续查询；</li></ul></li> <li>传送
<ul><li>外设就绪后，寻址数据口</li> <li>输入：IN指令从数据端口读入数据</li> <li>输出：OUT指令向数据端口输出数据</li></ul></li></ul> <h3 id="三、中断传送方式-int-21h"><a href="#三、中断传送方式-int-21h" class="header-anchor">#</a> 三、中断传送方式：int 21h</h3> <p>1、用中断服务子程序实现</p> <p>2、特点：</p> <ul><li>是一种效率较高的程序传送方式；</li> <li>中断服务程序是预先设计好的；</li> <li>CPU在每条指令周期后采样中断请求输入信号；</li> <li>外设需要传输数据时，主动向CPU提出中断请求，提高实时性；</li> <li>外设准备数据和CPU执行程序并行工作，提高CPU效率；</li> <li>每传输一次数据就要中断一次，需保护断点和现场；</li> <li>需要中断控制器8259芯片；</li> <li>适合少量数据、中慢速外设的数据传送，如鼠标、键盘。</li></ul> <p>3、中断过程：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>1、中断请求（外设）
2、中断响应（CPU）
3、关中断（CPU）
4、断点保护（CPU）
5、识别中断源（硬件/软件）
6、现场保护（用户）
7、中断服务：数据交换
8、恢复现场（用户）
9、开中断（CPU/用户）
10、中断fan'hui
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="四、dma传送方式"><a href="#四、dma传送方式" class="header-anchor">#</a> 四、DMA传送方式</h3> <p>1、特点：</p> <ul><li>克服程序控制传输的不足</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>外设-&gt;CPU-&gt;存储器
外设&lt;-CPU&lt;-存储器
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>直接存储器存取DMA：</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>外设-&gt;存储器
外设&lt;-存储器
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>DMA传送中，CPU释放总线，由DMA控制器（8237 ）管理。</p> <p>2、DMA传送原理</p> <ul><li>CPU对DMA控制器8237进行初始化设置；</li> <li>外设、DMAC和CPU三者通过应答信号建立联系：CPU将总线给DMAC控制；</li> <li>DMAC控制数据在内存和外设间传送送：
<ul><li>DMA读存储器：存储器-&gt;外设</li> <li>DMA写存储器：存储器&lt;-外设</li></ul></li> <li>自动增减地址和计数，判断传送完成否。</li> <li>传送完成后8237归还CPU总线</li></ul> <p>3、DMA传送过程</p> <ul><li>外设向DMA发出请求；</li> <li>DMAC向CPU申请总线（hold）；</li> <li>CPU完成当前总线周期后响应（hlda），并释放总线控制权；</li> <li>DMAC得到总线控制权，发出DMA响应信号；</li> <li>由DMAC发出读写控制信号，控制外设与存储器之间的数据传输；</li> <li>数据传送完成后，DMAC撤销HOLD信号；</li> <li>CPU释放HLDA信号，并重新控制总线。</li></ul> <p>总结：传送方式比较</p> <ul><li>无条件传送：慢速外设需要与CPU保持同步。</li> <li>查询传送：简单使用，CPU效率较低。</li> <li>中断传送：外设主动、实时性高，与CPU并行工作，CPU效率高，但每次传送需要大量额外时间开销，适用于中慢速外设。</li> <li>DMA传送：传送过程中由专门硬件DMAC控制，不需要CPU介入，外设直接和主存进行数据传送，适合大量、快速数据传送。</li></ul> <h1 id="可编程并行接口芯片8255a"><a href="#可编程并行接口芯片8255a" class="header-anchor">#</a> 可编程并行接口芯片8255A</h1> <h2 id="并行通信"><a href="#并行通信" class="header-anchor">#</a> 并行通信</h2> <ul><li>以计算机的字长（8位、16位或32位）为传输单位，一次传送一个字长的数据。</li> <li>适合外部设备与微机之间进行近距离、大量和快速的信息交换。</li></ul> <h2 id="一、8255a的内部结构和引脚"><a href="#一、8255a的内部结构和引脚" class="header-anchor">#</a> 一、8255A的内部结构和引脚：</h2> <ul><li>3个8位端口：端口A、端口B、端口C</li> <li>3种工作方式：方式0、方式1、方式2</li> <li>4个端口地址：端口A、端口B、端口C、控制口，地址</li> <li>2个控制字：
<ul><li>方式控制字：</li> <li>C口的按位置位/复位字：</li></ul></li></ul> <p>1、与外设连接的端口</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>端口A：PA0-PA7
	- 常作数据端口，共能最强大，
	- 支持工作方式0、1、2
端口B：PB0-PB7
	- 常作数据端口，支持工作方式0、1
端口C:PC0-PC7
	- 可作数据、状态、和控制端口
	- 分两个4位、每位可独立操作
	- 仅支持工作方式0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>2、处理器连接的引脚</p> <ul><li>数据线：8条</li> <li>地址线：2条，A0、A1</li> <li>CS片选信号</li> <li>RD读信号</li> <li>WR写信号</li> <li>RESET复位信号</li></ul> <p>3、8255的四个端口地址</p> <table><thead><tr><th style="text-align:center;">CS</th> <th style="text-align:center;">A1</th> <th style="text-align:center;">A0</th> <th style="text-align:center;">读操作RD</th> <th style="text-align:center;">写操作WR</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">读端口A</td> <td style="text-align:center;">写端口A</td></tr> <tr><td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">读端口B</td> <td style="text-align:center;">写端口B</td></tr> <tr><td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">读端口C</td> <td style="text-align:center;">写端口C</td></tr> <tr><td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">非法</td> <td style="text-align:center;">写控制口</td></tr></tbody></table> <h2 id="二、8255a的工作方式"><a href="#二、8255a的工作方式" class="header-anchor">#</a> 二、8255A的工作方式</h2> <p>1、三种工作方式</p> <ul><li>方式0：基本输入输出方式
<ul><li>适用于 无条件传送和查询方式的接口电路</li></ul></li> <li>方式1：选通输入输出方式
<ul><li>适用于 查询方式和中断方式的接口电路</li></ul></li> <li>方式2：双向选通输入传送方式
<ul><li>适用于 查询方式和中断方式的接口电路</li></ul></li></ul> <p>2、方式0：基本I/O方式</p> <ul><li>通常<strong>不用联络信号或不使用固定的联络信号</strong>；</li> <li>PA、PB和两个4位PC都可以作为数据的入/出（由程序设定）；</li> <li>方式0适于无条件传送和查询传送；</li> <li>输入时，使用IN指令；输出时，使用OUT指令</li></ul> <p>方式1：选通I/O方式</p> <ul><li>通常使用<strong>固定联络信号</strong>；</li> <li>适于查询和中断方式；</li> <li>可以产生中断；</li> <li>一般作为中断方式I/O</li> <li>输入时，使用IN指令；输出时，使用OUT指令</li></ul> <p>方式2：双向方式</p> <ul><li>方式2可以同时发送数据和接收数据</li> <li>只有端口A可以工作于方式2</li> <li>需要利用端口C的信号线</li></ul> <h2 id="三、8255a的编程"><a href="#三、8255a的编程" class="header-anchor">#</a> 三、8255A的编程</h2> <p>1、编程步骤：</p> <ul><li>根据题意明确三个端口的工作方式和方向</li> <li>确定两个字：方式控制字、置位/复位字</li> <li>确定4个端口地址：依次A、B、C、控制口</li> <li>8255的初始化编程：两个字送到控制端口</li> <li>8255的功能驱动编程。</li></ul> <p>2、方式控制字格式</p> <table><thead><tr><th style="text-align:center;">D7</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">1</td> <td style="text-align:center;">标志位</td></tr></tbody></table> <table><thead><tr><th style="text-align:center;">D6</th> <th style="text-align:center;">D5</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">A口方式0</td></tr> <tr><td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">A口方式1</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">A口方式2</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">A口方式2</td></tr></tbody></table> <table><thead><tr><th style="text-align:center;">D4</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">A口输出</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">A口输入</td></tr></tbody></table> <table><thead><tr><th style="text-align:center;">D3</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">PC7-PC4输出</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">PC7-PC4输入</td></tr></tbody></table> <table><thead><tr><th style="text-align:center;">D2</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">B口方式0</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">B口方式1</td></tr></tbody></table> <table><thead><tr><th style="text-align:center;">D1</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">B口输出</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">B口输入</td></tr></tbody></table> <table><thead><tr><th style="text-align:center;">D0</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">PC3-PC0输出</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">PC3-PC0输入</td></tr></tbody></table> <p>3、C口的置位/复位字</p> <table><thead><tr><th style="text-align:center;">D7</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">标志位</td></tr></tbody></table> <table><thead><tr><th style="text-align:center;">D6</th> <th style="text-align:center;">D5</th> <th style="text-align:center;">D4</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">x</td> <td style="text-align:center;">x</td> <td style="text-align:center;">x</td> <td style="text-align:center;">未用</td></tr></tbody></table> <table><thead><tr><th style="text-align:center;">D3</th> <th style="text-align:center;">D2</th> <th style="text-align:center;">D1</th> <th style="text-align:center;">选择C口的位</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">PC0</td></tr> <tr><td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">PC1</td></tr> <tr><td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">PC2</td></tr> <tr><td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">PC3</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">PC4</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">PC5</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">PC6</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">PC7</td></tr></tbody></table> <table><thead><tr><th style="text-align:center;">D0</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">选择的位 置 0</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">选择的位 置 1</td></tr></tbody></table> <h1 id="串行通信基础"><a href="#串行通信基础" class="header-anchor">#</a> 串行通信基础</h1> <h2 id="一、概念"><a href="#一、概念" class="header-anchor">#</a> 一、概念</h2> <p>1、串行通信</p> <ul><li><p>定义：将数据以二进制位形式用一条信号线，一位一位顺序传送的方式；</p></li> <li><p>特点：用于通信的线路少，适用于远距离数据传送，也常用于速度要求不高的近距离数据传送；</p></li> <li><p>应用：PC系列机上有两个串行异步通信接口、键盘、鼠标与主机间采用串行数据传送；</p></li></ul> <p>2、异步通信</p> <ul><li>串行通信时的数据、控制和状态信息都使用同一根信号线传送；</li> <li>收发双方必须遵守共同的通信协议（规程），才能解决传送速率、信息格式、同步、校验等问题；</li> <li>串行异少通信以宇符为单位进行传输，其通信协议是起止式异步通信协议。</li></ul> <p>协议格式：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>1位起始位：0
8位数据位：0/1
1位奇偶校验位：0/1	
	偶校验：包括校验位在内1的个数是偶数个
	奇校验：包括校验位在内1的个数是及数个
两位停止位：11
一帧：12位
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>数据传输率（比特率Bit Rate）</p> <ul><li>定义：每秒传输的二进制位数（bps）
<ul><li>单位：波特 或 bit/s</li></ul></li> <li>数据传输速率的倒数：每个二进制位传输的时间</li> <li>采用二进制传输时，比特率等于波特率</li> <li>串行异步通信的数据传输速率在50bps到9600bps之间。高达115200bps或更高。</li></ul> <p>波特因子</p> <ul><li><p>接收器或发送器的频率/数据传输的波特率</p></li> <li><p>在8251（可编程串行接口）芯片中有三种：1、16、64</p></li></ul> <p>3、同步通信</p> <ul><li>以一个数据块（帧）为传输单位，每一个数据块附加1个或2个同步字符，最后以检验字符结束。</li> <li>同步通信的数据传输效率和传输速率较高，但硬件电路比较复杂</li></ul> <p>数据格式：同步字符 8位数据 校验字符</p> <p>4、传输制式</p> <ul><li>全双工：可双向同时通信  —&gt; &lt;—</li> <li>半双工：可双向异步通信 &lt;—&gt;</li> <li>单共：只可单方向通信  —&gt;</li></ul> <h2 id="二、通用异步接收发送器uart-8251、8250"><a href="#二、通用异步接收发送器uart-8251、8250" class="header-anchor">#</a> 二、通用异步接收发送器UART（8251、8250）</h2> <ul><li>串行异步通信的接口芯片</li> <li>串行传输，需要并行到串行、串行到并行的转换，</li> <li>按照传输协议发送和接收每个字符（或数据块）</li></ul> <p>1、8250</p> <ul><li>8250实现了起止式串行异步通信协议，支持全双工通信
<ul><li>数据位为5—8位</li> <li>停止位1、1.5或2位</li> <li>奇偶奇偶校验1位</li> <li>具有奇偶、帧和溢出错误检测电路</li></ul></li> <li>8250支持的数据传输速率为50—9600bps</li></ul> <h1 id="控制器芯片"><a href="#控制器芯片" class="header-anchor">#</a> 控制器芯片</h1> <h2 id="一、中断控制器8259a"><a href="#一、中断控制器8259a" class="header-anchor">#</a> 一、中断控制器8259A</h2> <ul><li>可编程中断控制器PIC</li> <li>用于管理Intel 8086/8088、80286/80386的可屏蔽中断</li> <li>8259A的基本功能：
<ul><li>一片8259A可以管理8级中断，可扩展至64级</li> <li>每一级中断都可单独被屏蔽或允许</li> <li>在中断响应周期，可提供相应的中断向量号</li> <li>8259A有多种工作方式，可以通过编程选择</li></ul></li></ul> <p>1、内部寄存器</p> <ul><li>中断请求寄存器IRR：IR0—IR7</li> <li>中断服务寄存器ISR：ISR0—ISR7</li> <li>中断屏蔽寄存器IMR：IMR0—IMR7</li></ul> <p>2、与处理器接口</p> <table><thead><tr><th style="text-align:center;">A0</th> <th style="text-align:center;">RD(低电平有效)</th> <th style="text-align:center;">WR(低电平有效)</th> <th style="text-align:center;">CS(低电平有效)</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">写入ICW1、OCW2和OCW3</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">写入ICW2—ICW4和OCW1</td></tr> <tr><td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">读IRR、ISR和查询字</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">读出IMR</td></tr></tbody></table> <p>3、中断级连</p> <ul><li>8259A可以级联，一片8259A，可以级联最多8片从8259A；</li> <li>级联时，主8259A的<code>CAS0-CAS2</code>为输出线，连至从8259A的<code>CAS0-CAS2</code>，主片给从片送上被响应的从片编号;</li> <li>从8259A的INT，连主8259A的IR；</li> <li>主8259A的INT线连至CPU的INTR；</li> <li><span style="text-decoration:overline;">SP</span>/<span style="text-decoration:overline;">EN</span>在非缓冲方式下，<span style="text-decoration:overline;">SP</span>=1时，8259A是主片；<span style="text-decoration:overline;">SP</span>=0时，8259A是从片。</li> <li>地址线A0连接到各片8259上的A0口。</li></ul> <h2 id="二、8259a的中断过程"><a href="#二、8259a的中断过程" class="header-anchor">#</a> 二、8259A的中断过程</h2> <p>书P409页</p> <h2 id="三、8259a的工作方式"><a href="#三、8259a的工作方式" class="header-anchor">#</a> 三、8259A的工作方式</h2> <iframe src="https://wfmiss.cn/markmap/01.html" width="100%" height="400" frameborder="0" scrolling="No" leftmargin="0" topmargin="0"></iframe> <p>1、设置优先权方式</p> <ul><li>普通全嵌套方式</li></ul> <blockquote><ul><li>8259A的中断优先权顺序固定不变，从高到低依次为IR0&gt;……&gt;IR7</li> <li>中断请求后，8259A响应最高优先级，ISR对应位置=1，直到中断结束，ISR的位复位=0；</li> <li>在ISR期间，禁止同级和低级优先权的中断，但允许高级优先权中断嵌套。</li></ul></blockquote> <ul><li>特殊全嵌套方式</li></ul> <blockquote><p>CPU正在处理某一级中断时，只可对本级中断进行屏蔽，允许比它高或比它低的中断源开放。</p></blockquote> <ul><li>优先权自动循环方式</li></ul> <blockquote><ul><li>初始优先级顺序为IR0最高、IR7最低；</li> <li>当某一个中断源收到服务后，它的优先级改为最低，而比它低一级的中断源为最高优先级，其他级别依次类推。</li></ul></blockquote> <ul><li>优先权特殊循环方式</li></ul> <blockquote><p>与优先级自动循环方式基本相同，不同点在于可以根据用户要求将最低优先级赋予某一中断源。</p></blockquote> <p>2、结束中断处理方式</p> <p>什么是8259A的中断结束？</p> <blockquote><p>8259A利用中断服务寄存器ISR判断：</p> <ul><li>某位为1，表示正在进行中断服务；</li> <li>该位为0，就是该中断结束服务；</li></ul></blockquote> <p>如何使ISR某位为0：</p> <ul><li>自动中断结束方式</li></ul> <blockquote><p>当前CPU执行完某一个中断请求后ISR对应=0</p></blockquote> <ul><li>一般（普通）中断结束方式</li></ul> <blockquote><ul><li>配合全嵌套优先权方式使用</li> <li>当CPU往8259A发中断结束命令时，8259A就会把所有正在服务的中断优先权最高的ISR位复位。</li></ul></blockquote> <ul><li>特殊结束方式</li></ul> <blockquote><ul><li>配合循环优先权方式使用</li> <li>CPU向8259A发送一条特殊中断结束命令，指出要清除哪个ISR位。</li></ul></blockquote> <p>3、屏蔽中断源方式</p> <ul><li>普通屏蔽方式</li></ul> <blockquote><ul><li><p>只允许高优先级的中断源请求</p></li> <li><p>不允许同级别或低级别的中断源</p></li></ul></blockquote> <ul><li>特殊屏蔽方式</li></ul> <blockquote><ul><li>将IMR的Di位置1，使用ISR的Di位置0</li> <li>只对本级中断进行屏蔽</li></ul></blockquote> <p>4、中断请求方式</p> <ul><li>边沿触发方式</li></ul> <blockquote><p>中断请求输入出现的上升沿作为中断请求信号。不能跳变。</p></blockquote> <ul><li>电平触发方式</li></ul> <blockquote><p>中断请求端的高电平是有效的中断请求信号。响应后，必须撤销信号。</p></blockquote> <ul><li>中断查询方式</li></ul> <blockquote><p>IF=0（关中断），查询IR0—IR7有无中断请求。</p></blockquote> <p>5、数据线连接方式</p> <ul><li>缓冲方式</li></ul> <blockquote><ul><li>8259A的数据线需加缓冲器（驱动器）予以驱动</li> <li>多片级联的系统</li></ul></blockquote> <ul><li>非缓冲方式</li></ul> <blockquote><ul><li><span style="text-decoration:overline;">SP</span>/<span style="text-decoration:overline;">EN</span>引脚为输入端</li> <li>8259直接和数据线相连</li> <li>用于单片，引脚接高电平</li> <li>级联时，由于引脚确定是主片（高）或从片（低）</li></ul></blockquote> <h2 id="四、8259a的编程"><a href="#四、8259a的编程" class="header-anchor">#</a> 四、8259A的编程</h2> <h3 id="初始化编程"><a href="#初始化编程" class="header-anchor">#</a> 初始化编程</h3> <ul><li>8259A开始工作前，必须进行初始化编程</li> <li>给8259A写入初始化命令字ICW。</li></ul> <p>1、初始化命令字ICW</p> <ul><li>初始化命令字ICW最多有4个；</li> <li>必须按照ICW1-ICW4的顺序写入；</li> <li>ICW1和ICW2是必须送的；</li> <li>ICW3用于级联；</li> <li>ICW4用于8088/8086</li></ul> <p><strong>ICW1</strong></p> <ul><li>LTIM：触发方式</li> <li>ADI：服务程序间隔</li> <li>A0=0</li></ul> <table><thead><tr><th style="text-align:center;">位</th> <th style="text-align:center;">D7</th> <th style="text-align:center;">D6</th> <th style="text-align:center;">D5</th> <th style="text-align:center;">D4</th> <th style="text-align:center;">D3（LTIM）</th> <th style="text-align:center;">D2（ADI）</th> <th style="text-align:center;">D1（SNGL）</th> <th style="text-align:center;">D0（IC4）</th></tr></thead> <tbody><tr><td style="text-align:center;"></td> <td style="text-align:center;">X</td> <td style="text-align:center;">X</td> <td style="text-align:center;">X</td> <td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">0</td></tr> <tr><td style="text-align:center;">功能</td> <td style="text-align:center;">未用</td> <td style="text-align:center;">未用</td> <td style="text-align:center;">未用</td> <td style="text-align:center;"></td> <td style="text-align:center;">边沿触发</td> <td style="text-align:center;">间隔为8</td> <td style="text-align:center;">多片使用</td> <td style="text-align:center;">不需要ICW4</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">X</td> <td style="text-align:center;">X</td> <td style="text-align:center;">X</td> <td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">1</td></tr> <tr><td style="text-align:center;">功能</td> <td style="text-align:center;">未用</td> <td style="text-align:center;">未用</td> <td style="text-align:center;">未用</td> <td style="text-align:center;"></td> <td style="text-align:center;">电平触发</td> <td style="text-align:center;">间隔为4</td> <td style="text-align:center;">单片使用</td> <td style="text-align:center;">需要ICW4</td></tr></tbody></table> <p><strong>ICW2</strong></p> <ul><li>A0=1</li> <li>D7-D3：由用户决定（中断类型号高5位）</li> <li>D2-D0：由中断源引脚程序决定（IR0-IR7）</li></ul> <p><strong>ICW3</strong></p> <ul><li>主8259A</li></ul> <blockquote><ul><li>A0=1</li> <li>D7-D0：为1的位（该引脚有从片）；为0的位（该引脚未接有从片）</li></ul></blockquote> <ul><li>从8259A</li></ul> <blockquote><ul><li>A0=1</li> <li>D7-D3：未用（默认按0）</li> <li>D2-D0：接主片的（IR0-IR7分别对应000-111）</li></ul></blockquote> <p><strong>ICW4</strong></p> <ul><li>A0=1；</li> <li>D7-D5：未用（默认为0）；</li> <li>SFNM：嵌套方式选择；BUF：方式选择；M/S：主从选择；AEDI：结束方式；UPM：系统选择；</li></ul> <table><thead><tr><th style="text-align:center;">位</th> <th style="text-align:center;">D4（SFNM）</th> <th style="text-align:center;">D3（BUF）</th> <th style="text-align:center;">D2（M/S）</th> <th style="text-align:center;">D1（AEDI）</th> <th style="text-align:center;">D0（UPM）</th></tr></thead> <tbody><tr><td style="text-align:center;"></td> <td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">0</td></tr> <tr><td style="text-align:center;">功能</td> <td style="text-align:center;">普通全嵌套</td> <td style="text-align:center;">非缓冲方式</td> <td style="text-align:center;">本片为从片</td> <td style="text-align:center;">正常EOI</td> <td style="text-align:center;">8080/8085</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">1</td></tr> <tr><td style="text-align:center;">功能</td> <td style="text-align:center;">特殊全嵌套</td> <td style="text-align:center;">缓冲方式</td> <td style="text-align:center;">本片为主片</td> <td style="text-align:center;">自动EOI</td> <td style="text-align:center;">8086/8088</td></tr></tbody></table> <p>2、操作命令字OCW</p> <ul><li>8259A工作期间，可以接受操作命令字OCW；</li> <li>OCW共有三个：OCW1-OCW3；</li> <li>写入时没有顺序要求，需要哪个OCW就写入那个OCW；</li></ul> <p><strong>中断屏蔽操作字：OCW1</strong></p> <ul><li>A0=1，写入奇地址</li> <li>内容写入中断屏蔽寄存器IMR</li> <li>Mi对应IRi，为 1 禁止IRi中断、为 0 允许IRi中断；</li></ul> <p><strong>优先级循环和中断结束命令操作字：OCW2</strong></p> <ul><li>A0=0，写入偶地址</li></ul> <table><thead><tr><th style="text-align:center;">D7（R）</th> <th style="text-align:center;">D6（SL）</th> <th style="text-align:center;">D5（EOI）</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">清除优先级自动循环命令</td></tr> <tr><td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">普通EOI方式</td></tr> <tr><td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">无操作</td></tr> <tr><td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">特殊EOI方式</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">设置优先级自动循环命令</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">自动循环普通EOI方式</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">设置优先权命令</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">自动循环特殊EOI方式</td></tr></tbody></table> <ul><li>D4、D3为 0（标志位）</li> <li>D2-D0：分别对应IR0-IR7</li></ul> <p><strong>设置特殊屏蔽方式命令字：OCW3</strong></p> <ul><li>A0=0，写入偶地址</li> <li>D7为 0</li></ul> <table><thead><tr><th style="text-align:center;">D6（ESMM）</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">不允许特殊屏蔽方式</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">允许特殊屏蔽方式</td></tr></tbody></table> <table><thead><tr><th style="text-align:center;">D5（SMM）</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">撤销特殊屏蔽方式</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">设置特殊屏蔽方式</td></tr></tbody></table> <ul><li>D4=0，D3=1（标志位）</li></ul> <table><thead><tr><th style="text-align:center;">D2（P）</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">非查询命令</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">查询命令</td></tr></tbody></table> <table><thead><tr><th style="text-align:center;">D1（RR）</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">不发读命令</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">发读命令</td></tr></tbody></table> <table><thead><tr><th style="text-align:center;">D0（RIS）</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">读IRR</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">读ISR</td></tr></tbody></table> <h1 id="定时-计数控制器8253"><a href="#定时-计数控制器8253" class="header-anchor">#</a> 定时/计数控制器8253</h1> <h2 id="一、定时-计数器原理"><a href="#一、定时-计数器原理" class="header-anchor">#</a> 一、定时/计数器原理</h2> <ul><li>定时器：由计数电路构成，通过记录高精度晶振脉冲信号的个数，输出准确的时间间隔。</li> <li>计数器：计数电路如果记录外设提供的具有一定随机性的脉冲信号时，它主要反映脉冲的个数。</li> <li>均采用减一计数的倒计数原理，每过一个clk周期计算器减一。</li></ul> <p><strong>软件延时</strong></p> <ul><li>利用CPU执行一个延时程序实现；</li> <li>不用硬件，但占用CPU时间、定时精度不高，随系统主频改变。</li></ul> <p><strong>可编程的硬件定时</strong></p> <ul><li>软件硬件结合、可编程定时芯片</li> <li>能够输出多种控制信号</li></ul> <h2 id="二、8253的内部结构和引脚"><a href="#二、8253的内部结构和引脚" class="header-anchor">#</a> 二、8253的内部结构和引脚</h2> <p>1、原理</p> <ul><li>2种计数制：按二进制或BCD码计数</li> <li>3个独立的16位计数器</li> <li>4个端口地址</li> <li>6种工作方式</li></ul> <p>2、结构</p> <p>书P418</p> <p>3、引脚</p> <ul><li>CLK：时钟输入信号（Fclk，Tclk）</li> <li>GATE：们控输入信号
<ul><li>控制计数器是否计数</li> <li>两种：电平控制和上升沿控制</li></ul></li> <li>OUT：计数器输出信号
<ul><li>当计数值减为0，OUT引脚上产生一个输出信号。（Fout，Tout）</li></ul></li></ul> <p>4、与处理器接口</p> <ul><li>数据线：8位</li> <li>地址线：2位（A0、A1）</li> <li><span style="text-decoration:overline;">CS</span>片选</li> <li><span style="text-decoration:overline;">RD</span>读信号</li> <li><span style="text-decoration:overline;">WR</span>写信号</li></ul> <p>5、8253的I/O地址：4个</p> <table><thead><tr><th style="text-align:center;"><span style="text-decoration:overline;">CS</span></th> <th style="text-align:center;"><span style="text-decoration:overline;">RD</span></th> <th style="text-align:center;"><span style="text-decoration:overline;">WR</span></th> <th style="text-align:center;">A1</th> <th style="text-align:center;">A0</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">对计数器 0 设置计数初值</td></tr> <tr><td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">对计数器 1 设置计数初值</td></tr> <tr><td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">对计数器 2 设置计数初值</td></tr> <tr><td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">设置控制字到控制口</td></tr> <tr><td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">从计数器 0 读出计数值</td></tr> <tr><td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">从计数器 1 读出计数值</td></tr> <tr><td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">从计数器 2 读出计数值</td></tr></tbody></table> <h2 id="三、8253的工作方式"><a href="#三、8253的工作方式" class="header-anchor">#</a> 三、8253的工作方式</h2> <p>8253有6种工作方式，由方式控制字确定</p> <p>1、工作方式类型：</p> <ul><li><p>方式0：计数结束中断</p></li> <li><p>方式1：可编程单稳脉冲</p></li> <li><p>方式2：频率发生器（分频器）</p></li> <li><p>方式3：方波发生器</p></li> <li><p>方式4：软件触发选通信号</p></li> <li><p>方式5：硬件触发选通信号</p></li></ul> <p>2、工作方式特点：</p> <ul><li>只有方式 2 和 3 为自动装入初值循环计数；</li> <li>方式 1 和 5 由外部gate上升沿触发启动计数器；</li> <li>方式 0 - 4 为计数值启动后，开始计数；</li> <li>方式 1 的输出波形全为负电平：Tout=N*Tclk</li> <li>方式 2 的输出波形：Tout中有一个Tclk的负电平</li> <li>方式 3 初值N为偶数：N/2*Tout的高（低）电平
<ul><li>初值N为奇数：（N+1）/2*Tout的高（低）电平</li></ul></li></ul> <h2 id="四、8253的编程"><a href="#四、8253的编程" class="header-anchor">#</a> 四、8253的编程</h2> <p>1、确定8253的4个端口地址；</p> <p>2、确定CPU写入8253的初值和计数制（二进制0-65535、BCD码0-9999）</p> <p>3、确定CPU写入8253的方式控制字</p> <p>4、编写8253的初始化程序段</p> <p><strong>方式控制字</strong></p> <table><thead><tr><th style="text-align:center;">D7</th> <th style="text-align:center;">D6</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">选择计数器0</td></tr> <tr><td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">选择计数器1</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">选择计数器2</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">非法</td></tr></tbody></table> <table><thead><tr><th style="text-align:center;">D5</th> <th style="text-align:center;">D4</th> <th style="text-align:center;">功能</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">0</td> <td style="text-align:center;">计数器锁存命令</td></tr> <tr><td style="text-align:center;">0</td> <td style="text-align:center;">1</td> <td style="text-align:center;">只读写低字节</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">0</td> <td style="text-align:center;">只读写高字节</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">1</td> <td style="text-align:center;">先读写低字节，再读写高字节</td></tr></tbody></table> <ul><li>D3-D1：对应6种工作方式</li> <li>D0：为0选择二进制计数方式；为1选择BCD计数方式</li></ul> <p><strong>初值计算</strong></p> <p>初值（N）=Tout/Tclk=Fclk/Fout</p> <blockquote><p>Tclk=1/Fclk</p></blockquote> <h1 id="dma控制器8237a"><a href="#dma控制器8237a" class="header-anchor">#</a> DMA控制器8237A</h1> <h2 id="一、8237-dma概述"><a href="#一、8237-dma概述" class="header-anchor">#</a> 一、8237 DMA概述</h2> <p>为了提高数据传送效率，提出了DMA数据传送控制方式，由DMA控制器取代CPU，获得CPUD总线控制权，实现 <strong>内存与外设</strong> 或 <strong>内存的不同区域之间</strong> 或者 <strong>外设与外设</strong> 大量数据的快速传送。</p> <p>用于：图像的显示、磁盘的存取，磁盘间的数据传送等。</p> <h2 id="二、8237-dma数据传送的工作过程"><a href="#二、8237-dma数据传送的工作过程" class="header-anchor">#</a> 二、8237 DMA数据传送的工作过程</h2> <p>书：p427(图8-16)</p> <ul><li>接收从外设发出的DMA请求，并向CPU发出总线请求信号。</li> <li>当CPU响应请求，发出HLDA后，DMA控制器能接管对总线的控制，进入DMA操作方式。</li> <li>发出存储器地址，确定数据传送的地址单元，并能自动修改地址指针。</li> <li>识别数据传送的方向，发出读或写控制信号。</li> <li>确定传送数据的个数，判断传送是否结束。</li> <li>发出DMA操作的结束信号。</li></ul> <p><strong>需要注意的是：</strong></p> <blockquote><p>在内存与外设之间进行DMA传送期间，DMAC控制器只是输出地址及控制信号，而数据传送是直接在内存和外设端口之间进行的，并不是经过DMAC。</p></blockquote> <h2 id="三、dma控制器8237a"><a href="#三、dma控制器8237a" class="header-anchor">#</a> 三、DMA控制器8237A</h2> <ul><li>每个8237A芯片由4个DMA通道，即有4个DMA控制器；</li> <li>每个DMA通道具有不同的优先权；</li> <li>每个DMA通道可以分别允许和禁止</li> <li>每个DMA通道有四种工作方式</li> <li>一次传输的最大长度可达64KB</li></ul> <p>1、8237A的工作方式</p> <ul><li>DMA传送方式</li></ul> <blockquote><ul><li>单字节传送方式</li> <li>数据块传送方式</li> <li>请求级联方式</li> <li>级联方式</li></ul></blockquote> <ul><li>DMA传送类型</li></ul> <blockquote><ul><li>DMA读：读存储器—&gt;外设</li> <li>DMA写：外设—&gt;存储器</li> <li>DMA检验：</li></ul></blockquote></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/wfmiss/notes/edit/master/docs/02.练习题/04.输入输出系统接口芯片.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">最后更新:</span> <span class="time">2022/06/20, 23:06:00</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/c1/4/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">微机原理指令集</div></a> <a href="/c1/6/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">微机原理简答题</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/c1/4/" class="prev">微机原理指令集</a></span> <span class="next"><a href="/c1/6/">微机原理简答题</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/c1/4/"><div>
            微机原理指令集
            <!----></div></a> <span class="date">04-11</span></dt></dl><dl><dd>02</dd> <dt><a href="/c/note8/"><div>
            变量的存储类别及作用域
            <!----></div></a> <span class="date">03-23</span></dt></dl><dl><dd>03</dd> <dt><a href="/notes/0/"><div>
            报名流程
            <!----></div></a> <span class="date">03-10</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2022
    <span>wfmiss | notes</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f3f1a81b.js" defer></script><script src="/assets/js/2.b7d28b34.js" defer></script><script src="/assets/js/12.c81a73a2.js" defer></script>
  </body>
</html>
